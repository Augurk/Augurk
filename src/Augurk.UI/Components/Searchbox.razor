@using System.Threading
@using Augurk.Entities.Search
@inject SearchService searchService

<input type="text" placeholder="Type to search..." @bind-value="SearchTerm" @bind-value:event="oninput" />

@code {
    private string _searchTerm;
    private string SearchTerm{
        get { return _searchTerm; }
        set {
            _searchTerm = value;
            // Don't await the result
            var task = WaitAndSearch();
        }
    }

    private async Task WaitAndSearch(){
        var searchInput = _searchTerm;

        // Wait for half a second to determine whether the user is still typing
        await Task.Delay(500);

        // Don't do anything if the input has changed
        if(searchInput != _searchTerm)
        {
            return;
        }

        var task = searchService.Search(searchInput);
    }
}