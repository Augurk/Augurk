@using System.Threading
@using Augurk.Entities.Search
@inject SearchService searchService

<form class="form col-md-6 offset-md-3">
    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" @bind-value="SearchTerm" @bind-value:event="oninput" >
</form>

@code {
    private string _searchTerm;
    private string SearchTerm{
        get { return _searchTerm; }
        set {
            _searchTerm = value;
            // Don't await the result
            var task = WaitAndSearch();
        }
    }

    private async Task WaitAndSearch(){
        var searchInput = _searchTerm;

        // Wait for half a second to determine whether the user is still typing
        await Task.Delay(500);

        // Don't do anything if the input has changed
        if(searchInput != _searchTerm)
        {
            return;
        }

        var task = searchService.Search(searchInput);
    }
}